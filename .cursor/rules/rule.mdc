---
alwaysApply: true
---

# 命令行问题
* 命令行多个命令之间使用分号分隔，不要使用 && 分隔。
* 命令行中的中文会有编码问题，测试命令不要使用中文。

# 编码问题
* get_db().get_session() 返回的是 context manager（GeneratorContextManager），而不是 Session 对象。

错误用法：
session = self._get_db_session()  # 返回 context manager
with session:  # ❌ session 仍是 context manager
    self.AUTO_COLLECTION_ENABLED = self._load_setting(
        session, "auto_collection_enabled", ...  # ❌ 传递 context manager，不是 Session
    )

正确用法：
session = self._get_db_session()  # 返回 context manager
with session as s:  # ✅ s 是真正的 Session 对象
    self.AUTO_COLLECTION_ENABLED = self._load_setting(
        s, "auto_collection_enabled", ...  # ✅ 传递 Session
    )

# 代码Bug解决方法论
- **核心原则:第一性原理**
  - 深入分析，直击问题根源，拒绝任何掩盖表象的临时补丁或基于猜测的修复
- **结构化方法:系统化验证**
  - 当问题无法直接确定时，采用系统性手段收集证据，而非猜测:
    - **日志追踪:**增添日志，通过复现和分析运行时数据来定位问题。
    - **测试驱动:**编写可复现的测试用例，精确隔离并验证缺陷。
- **最终目标:根除问题**
  - 通过一切必要手段，确保找到并彻底解决问题的根本原因。

### 文档维护核心原则
- **`README.md` 是唯一入口**
  - **保持精简**：只保留项目简介、快速上手和功能亮点。
  - **扮演目录**：对于复杂内容，在 README 中提供清晰链接，指向 `docs/` 目录下的详细文件。
- **详细文档归入 `docs/` 目录**
  - 所有非核心、详细的说明文档（如架构设计、API 指南、教程）统一存放在 `docs/` 目录内。
- **文档与代码必须同步**
  - **代码变更，文档同步**：修改代码后，必须同步更新所有相关文档。
  - **审查环节**：文档的更新是合并请求 (Pull Request) 的一部分，必须与代码一同被审查。
- **内容质量**
  - **精炼、准确、无废话**。
  - 优先使用**代码示例**和**图表**进行说明，让文档更易理解。
